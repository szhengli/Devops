package main

import (
	"time"

	"github.com/jessevdk/go-assets"
)

var _Assets9f0ae851af9adb08e3242917d7d52dc270c7bae2 = "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <style>\r\n        table, th, td {\r\n            border: 1px solid black;\r\n            border-collapse: collapse;\r\n        }\r\n    </style>\r\n    <meta charset=\"UTF-8\">\r\n    <script src=\"https://apps.bdimg.com/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n    <title>Title</title>\r\n</head>\r\n<body>\r\n    <h1>\r\n                     生产发布回滚申请，请慎重选择！\r\n    </h1>\r\n\r\n\r\n    <p> 请选择需要回滚的发布单（或同步单的钉钉审批单编号）  </p>\r\n\r\n    <form>\r\n      <label for=\"dingIDSelect\">审批单号选择:</label>\r\n\r\n      <select  id=\"dingIDSelect\"  name=\"dingID\"  onchange=\"check()\">\r\n         <option value=\"\">Select Option</option>\r\n      </select>\r\n      <br><br>\r\n\r\n        <div id=\"releaseDetails\">\r\n            <label> 分支号：  </label>\r\n            <div id=\"branch\">\r\n            </div>\r\n              <br>\r\n            <label> 系统清单：  </label>\r\n            <ui id=\"serviceList\">\r\n            </ui>\r\n\r\n        </div>\r\n\r\n        <br>\r\n    </form>\r\n\r\n    <button id=\"rollback\" value=\"提交回滚申请\" onclick=\"rollback()\"> 确认回滚 </button>\r\n\r\n    <br>\r\n    <br>\r\n    <div id=\"report\">\r\n    </div>\r\n\r\n    <script>\r\n\r\n    function sleep(time){\r\n        var timeStamp = new Date().getTime();\r\n        var endTime = timeStamp + time;\r\n        while(true){\r\n            if (new Date().getTime() > endTime){\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    function rollback(){\r\n\r\n       dingID = $(\"#dingIDSelect\").val()\r\n\r\n        $.get(\"/rollback/start\", {dingID: dingID} , function(res) {\r\n            $(\"#report\").empty()\r\n            $(\"#report\").html(res)\r\n            console.log(res)\r\n           })\r\n\r\n        //sleep(300)\r\n        //i = 0\r\n        //while (i<80) {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            //sleep(3000)\r\n        //}\r\n        console.log(\"can you see me??\")\r\n    }\r\n\r\n\r\n    function check(){\r\n        const dingID = document.getElementById(\"dingIDSelect\").value\r\n        if (dingID == \"\") {\r\n            $(\"#serviceList\").empty()\r\n            $(\"#branch\").empty()\r\n            return\r\n        }\r\n        $.get(\"/rollback/getReleaseDetails\", {dingID: dingID} , function(res) {\r\n\r\n            $(\"#branch\").html(res[\"branch\"])\r\n\r\n            $(\"#serviceList\").empty()\r\n\r\n            res[\"serviceList\"].forEach(service => {\r\n                $(\"#serviceList\").append('<li>' + service+ '</li>')\r\n            })\r\n\r\n\r\n            console.log(res)\r\n        })\r\n\r\n    }\r\n\r\n\r\n\r\n    // Function to fetch JSON data and populate select element\r\nfunction populateSelect() {\r\n  // URL of the JSON file or API endpoint\r\n  const url = '/rollback/getReleases'; // Replace with your JSON data source URL\r\n\r\n  // Fetch JSON data\r\n  fetch(url)\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error('网络响应异常！');\r\n      }\r\n      console.log(\"xxxxxxxxx\")\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      // Get select element\r\n\r\n      console.log(data)\r\n\r\n      const select = document.getElementById('dingIDSelect');\r\n\r\n      // Clear existing options\r\n      select.innerHTML = '';\r\n\r\n      // Add options from JSON data\r\n        FirstElement = document.createElement('option');\r\n        FirstElement.value = \"\";\r\n        FirstElement.textContent = \"\";\r\n        select.appendChild( FirstElement);\r\n\r\n        data = data.sort().reverse().slice(0,10)\r\n        data.forEach(option => {\r\n        const optionElement = document.createElement('option');\r\n        optionElement.value = option;\r\n        optionElement.textContent = option;\r\n        select.appendChild(optionElement);\r\n      });\r\n    })\r\n    .catch(error => {\r\n      console.error('There was a problem fetching the data:', error);\r\n    });\r\n}\r\n\r\n// Call the function to populate select element\r\npopulateSelect();\r\n</script>\r\n\r\n</body>\r\n</html>"
var _Assets5c87d2b7aac8f50b10a68835116fe8b2d304c3c6 = "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <style>\r\n        table, th, td {\r\n            border: 1px solid black;\r\n            border-collapse: collapse;\r\n        }\r\n    </style>\r\n    <meta charset=\"UTF-8\">\r\n    <script src=\"https://apps.bdimg.com/libs/jquery/1.7.2/jquery.min.js\"></script>\r\n    <title>Title</title>\r\n</head>\r\n<body>index.html\r\n    <h1>\r\n                     生产发布回滚申请，请始终选择！\r\n    </h1>\r\n\r\n\r\n    <p> 请选择需要回滚的发布单（或同步单的钉钉审批单编号）  </p>\r\n\r\n    <form>\r\n      <label for=\"dingIDSelect\">审批单号选择:</label>\r\n\r\n      <select  id=\"dingIDSelect\"  name=\"dingID\"  onchange=\"check()\">\r\n         <option value=\"\">Select Option</option>\r\n      </select>\r\n      <br><br>\r\n\r\n        <div id=\"releaseDetails\">\r\n            <label> 分支号：  </label>\r\n            <div id=\"branch\">\r\n            </div>\r\n              <br>\r\n            <label> 系统清单：  </label>\r\n            <ui id=\"serviceList\">\r\n            </ui>\r\n\r\n        </div>\r\n\r\n        <br>\r\n    </form>\r\n\r\n    <button id=\"rollback\" value=\"提交回滚申请\" onclick=\"rollback()\"> 确认回滚 </button>\r\n\r\n    <br>\r\n    <br>\r\n    <div id=\"report\">\r\n    </div>\r\n\r\n\r\n    <table id=\"progress\" style=\"width:50%\">\r\n        <thead>\r\n        <tr>\r\n            <th>系统</th>\r\n            <th>状态</th>\r\n        </tr>\r\n        </thead>\r\n        <tbody>\r\n        <!-- Table rows will be added here dynamically -->\r\n        </tbody>\r\n    </table>\r\n\r\n    <script>\r\n\r\n    function sleep(time){\r\n        var timeStamp = new Date().getTime();\r\n        var endTime = timeStamp + time;\r\n        while(true){\r\n            if (new Date().getTime() > endTime){\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    function rollback(){\r\n\r\n       dingID = $(\"#dingIDSelect\").val()\r\n\r\n        $.get(\"/rollback/start\", {dingID: dingID} , function(res) {\r\n            $(\"#report\").empty()\r\n            $(\"#report\").html(res)\r\n            console.log(res)\r\n           })\r\n\r\n        //sleep(300)\r\n        //i = 0\r\n        //while (i<80) {\r\n\r\n          //  i ++\r\n        refeshID = setInterval(()=>{\r\n            $('#progress tbody').empty()\r\n\r\n            $.get(\"/rollback/getReport\", {dingID: dingID}, function (res) {\r\n                details = res[\"records\"]\r\n                total = details.length\r\n                done = 0\r\n                details.forEach(rowdata => {\r\n\r\n                    if (rowdata[\"state\"] === \"completed\" ||  rowdata[\"state\"] === \"unsupported\")  {\r\n                        done ++\r\n                    }\r\n                    console.log(rowdata[\"service\"] + \":  \" + rowdata[\"state\"])\r\n\r\n                    $('#progress tbody').append('<tr><td>' + rowdata[\"service\"] + '</td><td>' + rowdata[\"state\"] + '</td></tr>');\r\n\r\n\r\n                    console.log(res)\r\n                })\r\n\r\n                if (done === total ) {\r\n                    clearInterval( refeshID )\r\n                    $(\"#report\").html('<h1 style=\"background-color:MediumSeaGreen; width: 50%\">回滚正常完成！！</h1>')\r\n                    console.log(\"all done++++++++++++\")\r\n                }\r\n\r\n            })\r\n        }, 1000)\r\n\r\n\r\n\r\n\r\n\r\n            //sleep(3000)\r\n        //}\r\n        console.log(\"can you see me??\")\r\n    }\r\n\r\n\r\n    function check(){\r\n        const dingID = document.getElementById(\"dingIDSelect\").value\r\n        if (dingID == \"\") {\r\n            $(\"#serviceList\").empty()\r\n            $(\"#branch\").empty()\r\n            return\r\n        }\r\n        $.get(\"/rollback/getReleaseDetails\", {dingID: dingID} , function(res) {\r\n\r\n            $(\"#branch\").html(res[\"branch\"])\r\n\r\n            $(\"#serviceList\").empty()\r\n\r\n            res[\"serviceList\"].forEach(service => {\r\n                $(\"#serviceList\").append('<li>' + service+ '</li>')\r\n            })\r\n\r\n\r\n            console.log(res)\r\n        })\r\n\r\n    }\r\n\r\n\r\n\r\n    // Function to fetch JSON data and populate select element\r\nfunction populateSelect() {\r\n  // URL of the JSON file or API endpoint\r\n  const url = '/rollback/getReleases'; // Replace with your JSON data source URL\r\n\r\n  // Fetch JSON data\r\n  fetch(url)\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        throw new Error('网络响应异常！');\r\n      }\r\n      console.log(\"xxxxxxxxx\")\r\n      return response.json();\r\n    })\r\n    .then(data => {\r\n      // Get select element\r\n\r\n      console.log(data)\r\n      const select = document.getElementById('dingIDSelect');\r\n\r\n      // Clear existing options\r\n      select.innerHTML = '';\r\n\r\n      // Add options from JSON data\r\n        FirstElement = document.createElement('option');\r\n        FirstElement.value = \"\";\r\n        FirstElement.textContent = \"\";\r\n        select.appendChild( FirstElement);\r\n\r\n      data.forEach(option => {\r\n        const optionElement = document.createElement('option');\r\n        optionElement.value = option;\r\n        optionElement.textContent = option;\r\n        select.appendChild(optionElement);\r\n      });\r\n    })\r\n    .catch(error => {\r\n      console.error('There was a problem fetching the data:', error);\r\n    });\r\n}\r\n\r\n// Call the function to populate select element\r\npopulateSelect();\r\n</script>\r\n\r\n</body>\r\n</html>"

// Assets returns go-assets FileSystem
var Assets = assets.NewFileSystem(map[string][]string{"/": []string{".\\templates"}, "/templates": []string{"index.html", "index.html.report"}}, map[string]*assets.File{
	"/": &assets.File{
		Path:     "/",
		FileMode: 0x800001ff,
		Mtime:    time.Unix(1716799890, 1716799890393854500),
		Data:     nil,
	}, "/templates": &assets.File{
		Path:     "/templates",
		FileMode: 0x800001ff,
		Mtime:    time.Unix(1717146026, 1717146026623702700),
		Data:     nil,
	}, "/templates/index.html": &assets.File{
		Path:     "/templates/index.html",
		FileMode: 0x1b6,
		Mtime:    time.Unix(1717146026, 1717146026623702700),
		Data:     []byte(_Assets9f0ae851af9adb08e3242917d7d52dc270c7bae2),
	}, "/templates/index.html.report": &assets.File{
		Path:     "/templates/index.html.report",
		FileMode: 0x1b6,
		Mtime:    time.Unix(1716798175, 1716798175688061300),
		Data:     []byte(_Assets5c87d2b7aac8f50b10a68835116fe8b2d304c3c6),
	}}, "")
